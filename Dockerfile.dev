# Base image with Rust + Cargo
FROM rust:trixie as builder

WORKDIR /usr/src/app

# Copy Cargo files first (for caching)
COPY Cargo.toml Cargo.lock ./

# Install SeaORM CLI
RUN cargo install sea-orm-cli

# Install cargo-watch for hot reload
RUN cargo install cargo-watch

# Copy source code
COPY ./src ./src

# Expose app port
EXPOSE 8080

# Run hot reload
CMD ["cargo", "watch", "-x", "run"]
